{"version":3,"sources":["Provider.es6"],"names":[],"mappings":"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","file":"Provider.js","sourcesContent":["\nclass Provider {\n\n    constructor(name, logo, url, moredeals, platform, location, appearance) {\n        this.name = name;\n        this.logo = logo;\n        this.url = url;\n        this.moredeals = moredeals;\n        this.platform = platform;\n        this.location = location;\n        this.appearance = appearance;\n        this.apps = [];\n\n        Providers.add(this);\n    }\n\n    // Add new provider entry\n    // SVG source: http://codepen.io/mrrocks/pen/EiplA\n    addEntry() {\n        if(this.preference) {\n            $(`.${this.location}`).append(\n                `<article class='provider-entry ${this.columns} ${this.name} clearfix'>\n                    <header class='provider-header'>\n                        <img class='provider-logo' src='${this.logo}'>\n                        <svg class='spinner' width='65px' height='65px' viewBox='0 0 66 66' xmlns='http://www.w3.org/2000/svg'><circle class='path' fill='none' stroke-width='6' stroke-linecap='round' cx='33' cy='33' r='30'></circle></svg>\n                    </header>\n                    <div class='provider-body'></div>\n                </article>`\n            );\n        }\n    };\n\n    // Add new app list within a provider entry\n    addAppList() {\n        if(this.preference) {\n            $(`.${this.location} .${this.name} .provider-body`).append(\n                `<section class='app-list'><a class='btn_more_deals' href=${this.moredeals} target='blank'>More deals</a></section>`\n            );\n        }\n    };\n\n    addFallback() {\n        $(`.${this.location} .${this.name} .provider-body`).append(\"<p class=\\'noapps\\'>Unfortunately, there are no apps to display here today.<br>Come back tomorrow!</p>\");\n    };\n\n    load() {\n        var provider = this;\n        this.preference = Preferences.isProviderEnabled(this.name);\n        this.addEntry();\n\n        return ajax({\n            url: 'crosscall.php',\n            data: {url: provider.url},\n            type: 'POST'\n        })\n            .then(\n                (html) => {\n                    return new Promise((resolve) => {\n                        provider.handler(html);\n\n                        if(provider.apps.length == 0) {\n                            provider.addFallback();\n\n                        } else {\n                            if(this.appearance == \"app-list\") {\n                                provider.addAppList();\n                            }\n\n                            $.each(provider.apps, (i, app) => {\n                                app.appendToPage();\n                            });\n                        }\n\n                        resolve();\n                    });\n                },\n                (error) => console.error(\"Error loading data: \" + error))\n\n            .then(() => provider.finish());\n    };\n\n    finish() {\n        console.log(`Finished loading ${this.name} provider.`);\n\n        // Re-arrange the articles for the tablet layout\n        if($(window).width() < 1500 && $(window).width() > 1150) {\n            if(Platform.active === \"ipad\") {\n                $(`.${this.location}`).children().css(\"float\", \"left\");\n            }\n\n            /*if(this.location === \"col-2\") {\n                $(`.${this.location} .${this.name}`).appendTo(\".col-1\");\n                this.location = \"col-1\";\n\n            } else if(this.location === \"col-3\") {\n                $(`.${this.location} .${this.name}`).appendTo(\".col-2\");\n                this.location = \"col-2\";\n            }*/\n        }\n\n        $(`.${this.location} .${this.name} .spinner`).fadeOut(200);\n        $(`.${this.location} .${this.name}`).height($(`.${this.location} .${this.name}`).height());\n        $(`.${this.location} .${this.name} .provider-body`).slideDown({\n            easing: \"easeInOutQuint\", duration: 700\n        });\n    }\n\n    get apps() {\n        return this._apps;\n    }\n\n    set apps(apps) {\n        this._apps = apps;\n    }\n}"]}